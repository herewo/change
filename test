def platform = 'android'
def label_name = 'JPUSa'
def workspace = "${project_path}/res_project"
def log_dir = "${project_path}/build_logs/CheckI18NAssets"
def unity_dir = 'C:\\Program Files\\Unity\\Hub\\Editor\\2021.3.30f1c1'
def unity = "\"${unity_dir}\\Editor\\Unity.exe\""

pipeline {
    agent {
        label {
            label "${label_name}"
            customWorkspace "${workspace}"
        }
    }
    stages {
        stage('2 - I18NResourceCheck') {
            steps { script{ dir("${workspace}") {
                bat "del /f /q errorResourcesInfo.txt"
                try{
                    bat "${unity} -projectPath ${workspace}/client -logFile ${log_dir}/${env.BUILD_NUMBER}_build_I18NResCheck_jenkins.log -buildTarget ${platform} -executeMethod BuildResource.CheckI18NAssets -dst_dir ${workspace} -batchmode -nographics -quit"
                }
                catch(exc)
                {
                    unstable("check error！！！")                
                }
            }}}
        }
    }
}
